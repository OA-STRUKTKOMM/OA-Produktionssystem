<?xml version="1.0" encoding="utf-8"?><html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xml:lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
      <link rel="stylesheet" type="text/css" href="../Styles/HTWK-OAVerlag.css" />
      <title>Fehlerbehebung Excel-Arbeitsmappe</title>
   </head>
   <body>
      <div class="appendix" id="b_9783966270021_app_008">
         <h1>Anhang H Fehlerbehebung Excel-Arbeitsmappe</h1>
         
         
         <p class="DOI">DOI Kapitel:  <a href="http://doi.org/10.33968/9783966270021-14">http://doi.org/10.33968/9783966270021-14</a></p>
         
         
         
         
         <div class="chapter" id="b_9783966270021_app_008_001">
            <h2> Makros aktivieren</h2>
            
            
            <p class="normal">Für die Nachweisführung in Verbindung mit VBA in Excel sind im Voraus
               einige grundlegende Einstellungen vorzunehmen. Ansonsten wird während
               der Berechnung möglicherweise eine Fehlermeldung erscheinen. In diesem
               Anhang soll dem Anwender eine Hilfestellung für die Lösung der möglichen
               auftretenden Fehlermeldungen geliefert werden, um eine uneingeschränkte
               Anwendung der Excel-Arbeitsmappe zu ermöglichen. Dabei werden die
               Fehlerursachen betrachtet, die während der probeweisen Berechnungen
               aufgetreten sind. Es besteht jedoch die Möglichkeit, dass weitere
               Fehlermeldungen erscheinen, die zum jetzigen Zeitpunkt noch unbekannt
               sind. Für alle bekannten Fehlermeldungen wird im Folgenden lediglich ein
               möglicher Lösungsweg aufgezeigt, auch wenn es mehrere zielführende Wege
               gibt.</p>
            
            <p class="normal">Eine grundlegende Voraussetzung wurde bereits in <a href="Kapitel_3.xhtml#b_9783966270021_chapter_003_003_002_002">Kapitel 3.3.2.2</a>
               geschildert. Um die Funktion der Excel-Arbeitsmappe überhaupt nutzen zu
               können, müssen die hinterlegten Makros zugelassen werden. Dazu muss beim
               Starten der Arbeitsmappe lediglich die Schaltfläche „Inhalt aktivieren“
               betätigt werden.</p>
            </div>
         
         <div class="chapter" id="b_9783966270021_app_008_002">
            <h2> Solver Add-In installieren</h2>
            
            
            <p class="normal">Sofern die Inhalte aktiviert sind, startet das Makro „AutoOpen“ die
               Eingabemaske. Dabei sind während der probeweisen Berechnungen keine
               Probleme aufgetreten. Alle Pop-Up-Fenster, die während der Eingabe
               erscheinen, dienen zur Begrenzung der Eingabewerte und sind durch den
               Anwender zu beheben, indem Werte im jeweils zulässigen Bereich
               eingegeben werden. Nachdem alle Eingaben getätigt wurden und die
               Berechnung startet, kann eine Excel-Fehlermeldung aufgrund des fehlenden
               Solver-Add-Ins auftreten. Diese kann mit „OK“ bestätigt werden.</p>
            <a id="b_9783966270021_fig_072"></a><figure><img src="../Images/b_9783966270021_fig_072.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_072.jpg" /><figcaption><label>Abb. H.1</label>
                  Fehlermeldung (Solver Add-in nicht installiert)
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-01">http://doi.org/10.33968/9783966270021-14-A-01</a>)</figcaption>
            </figure>
            
            <p class="normal">Da das Solver Add-In zwar von Excel mitgeliefert wird, aber nicht
               automatisch installiert ist, muss dies vor der ersten Anwendung durch
               den Nutzer durchgeführt werden. Über die Menüschaltflächen Datei →
               Optionen → Add-Ins werden die bereits installierten Add-Ins
               angezeigt. Durch Bestätigen der Schaltfläche „Los“ im unteren Teil des
               Fensters werden die verfügbaren Add-Ins angezeigt. Dabei ist zu
               beachten, dass in dem Auswahlfenster („Verwalten:“) die Excel-Add-Ins
               ausgewählt sind.</p>
            <a id="b_9783966270021_fig_073"></a><figure><img src="../Images/b_9783966270021_fig_073.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_073.jpg" /><figcaption><label>Abb. H.2</label>
                  Excel-Add-Ins
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-02">http://doi.org/10.33968/9783966270021-14-A-02</a>)</figcaption>
            </figure>
            
            <p class="normal">Hier muss bei dem Eintrag „Solver“ der Haken gesetzt werden. Anschließend
               kann mit „OK“ bestätigt werden. Der Solver ist jetzt installiert und im
               oberen Menüband der Excel-Arbeitsmappe unter dem Reiter „Daten“
               verfügbar.</p>
            <a id="b_9783966270021_fig_074"></a><figure><img src="../Images/b_9783966270021_fig_074.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_074.jpg" /><figcaption><label>Abb. H.3</label>
                  Solver aktivieren
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-03">http://doi.org/10.33968/9783966270021-14-A-03</a>)</figcaption>
            </figure>
            </div>
         
         <div class="chapter" id="b_9783966270021_app_008_003">
            <h2> VBA Solver-Verweis</h2>
            
            
            <p class="normal">Ist der Solver installiert, können prinzipiell die iterativen
               Berechnungen in der Nachweisführung von der Excel-Arbeitsmappe
               durchgeführt werden. Sofern die Eingaben per Hand in den Solver
               eingetragen werden, tritt auch keine weitere Fehlermeldung auf. Da die
               Berechnung aber mittels Makros automatisiert ablaufen soll, muss auch
               VBA auf den Solver zugreifen können. Dazu muss ein Verweis auf die
               Solver-Datei im VBA-Editor erzeugt werden, denn sonst wird wieder
               folgende Meldung auf dem Bildschirm erscheinen:</p>
            <a id="b_9783966270021_fig_075"></a><figure><img src="../Images/b_9783966270021_fig_075.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_075.jpg" /><figcaption><label>Abb. H.4</label>
                  Fehlermeldung (VBA Solver-Verweis fehlt)
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-04">http://doi.org/10.33968/9783966270021-14-A-04</a>)</figcaption>
            </figure>
            
            <p class="normal">An dieser Stelle kann der Vorgang mit „OK“ bestätigt werden. Um den
               Verweis zu setzen, muss der VBA-Editor gestartet werden. Eine
               Möglichkeit dazu besteht mit der Tastenkombination ALT + F11. Als
               nächstes muss der Vorgang gestoppt werden, da der VBA-Editor sonst keine
               Änderung in den Verweisen zulässt. Dies kann über das blaue Quadrat in
               der Symbolleiste erfolgen.</p>
            <a id="b_9783966270021_fig_076"></a><figure><img src="../Images/b_9783966270021_fig_076.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_076.jpg" /><figcaption><label>Abb. H.5</label>
                  Makro stoppen
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-05">http://doi.org/10.33968/9783966270021-14-A-05</a>)</figcaption>
            </figure>
            
            <p class="normal">Über den Menüpunkt „Extras“ können die verfügbaren Verweise geöffnet
               werden.</p>
            <a id="b_9783966270021_fig_077"></a><figure><img src="../Images/b_9783966270021_fig_077.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_077.jpg" /><figcaption><label>Abb. H.6</label>
                  VBA-Verweise öffnen
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-06">http://doi.org/10.33968/9783966270021-14-A-06</a>)</figcaption>
            </figure>
            
            <p class="normal">Anschließend muss der Haken beim Solver gesetzt und die Auswahl mit „OK“
               bestätigt werden. Sollte das Solver-Add-In noch nicht installiert sein,
               ist der Solver hier noch nicht zu finden. Dann muss zuerst der Solver,
               wie vorab beschrieben, installiert werden.</p>
            <a id="b_9783966270021_fig_078"></a><figure><img src="../Images/b_9783966270021_fig_078.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_078.jpg" /><figcaption><label>Abb. H.7</label>
                  Solver-Verweis setzen
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-07">http://doi.org/10.33968/9783966270021-14-A-07</a>)</figcaption>
            </figure>
            
            <p class="normal">Sobald der Verweis auf den Solver gesetzt ist kann der VBA-Editor
               geschlossen und mit der Berechnung begonnen werden. Die Berechnung
               sollte nun unproblematisch durchgeführt werden können.</p>
            </div>
         
         <div class="chapter" id="b_9783966270021_app_008_004">
            <h2> Einstellungsänderungen durch Makros</h2>
            
            
            <p class="normal">Aufgrund der Vorgehensweise der Makros kann es teilweise auch zu
               unerwünschten Änderungen an grundlegenden Einstellungen der Arbeitsmappe
               kommen, die aber keine Auswirkung auf die Berechnung haben. Teilweise
               wird während der Ausführung der Makros die automatische Berechnung des
               aktiven Excel-Arbeitsblatts zurückgesetzt, sodass erst nach dem
               Speichern die Werte neu berechnet und ausgegeben werden. Um die
               automatische Anzeige wiederherzustellen, muss die entsprechende Auswahl
               in den Optionen getroffen werden. Wann und ob dieser Fehler auftritt und
               worin dessen Ursache liegt, ist zum jetzigen Zeitpunkt nicht genau
               bekannt. Da dadurch aber keine ausschlaggebende Einschränkung der
               Excel-Arbeitsmappe herbeigeführt wird und dieser Fehler vergleichsweise
               selten auftritt, bleibt die Ursachenforschung an dieser Stelle
               unberücksichtigt.</p>
            <a id="b_9783966270021_fig_079"></a><figure><img src="../Images/b_9783966270021_fig_079.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_079.jpg" /><figcaption><label>Abb. H.8</label>
                  automatische Arbeitsmappenberechnung aktivieren
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-08">http://doi.org/10.33968/9783966270021-14-A-08</a>)</figcaption>
            </figure>
            
            <p class="normal">Außerdem kann es vorkommen, dass die „numlock“-Taste unbeabsichtigt durch
               die Ausführung der hinterlegten Makros aktiviert bzw. deaktiviert wird.
               Da der Solver bei der ersten Iteration die Fehlermeldung ausgibt, dass
               die Zielzelle auf dem aktiven Arbeitsblatt liegen muss, wurde ein Befehl
               in dem Makro formuliert, der die Taste „Enter“ zur Bestätigung an Excel
               sendet, sodass der Nutzer diese Fehlermeldung nicht nach jedem
               Berechnungsvorgang bestätigen muss.</p>
            <a id="b_9783966270021_fig_080"></a><figure><img src="../Images/b_9783966270021_fig_080.jpg" alt="Bildquelle:../Images/b_9783966270021_fig_080.jpg" /><figcaption><label>Abb. H.9</label>
                  Fehlermeldung Zielzelle
                   (DOI: <a href="http://doi.org/10.33968/9783966270021-14-A-09">http://doi.org/10.33968/9783966270021-14-A-09</a>)</figcaption>
            </figure>
            
            <p class="normal">Vermutlich tritt der Fehler an dieser Stelle auf, denn dabei werden jedes
               Mal die Tastatureinstellungen abgefragt. Da diese Einstellung mit
               äußerst geringem Aufwand wieder in den gewünschten Zustand zu bringen
               ist und die Anwenderfreundlichkeit durch den integrierten Befehl
               deutlich zunimmt, wird dieser Fehler an dieser Stelle akzeptiert.</p>
            </div>
         
         </div>
   </body>
</html>